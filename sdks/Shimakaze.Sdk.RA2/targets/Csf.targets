<?xml version="1.0" encoding="UTF-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <ItemGroup>
    <__CSF
      Include="@(CsfFile)"
      Destination="$(IntermediateOutputPath)%(RecursiveDir)%(Filename).g%(Extension).csf"
      Tag="%(Tag)" />
  </ItemGroup>

  <Target
    Name="__BuildCsf"
    Inputs="@(__CSF)"
    Outputs="%(__CSF.Destination)">
    <CsfBuilder SourceFiles="@(__CSF)">
      <Output TaskParameter="OutputFiles" ItemName="CsfFile" />
    </CsfBuilder>
  </Target>

  <Target
    Name="__MergeCsf"
    Inputs="@(CsfFile)"
    Outputs="$(OutputPath)\$(CsfFileName)">
    <CsfMerger
      SourceFiles="@(CsfFile)"
      DestinationFile="$(OutputPath)$(CsfFileName)">
      <Output TaskParameter="OutputFile" ItemName="None" />
    </CsfMerger>
  </Target>
</Project>